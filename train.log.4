W0321 21:11:25.206000 19847 /ocean/projects/cis210027p/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/run.py:793] 
W0321 21:11:25.206000 19847 /ocean/projects/cis210027p/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/run.py:793] *****************************************
W0321 21:11:25.206000 19847 /ocean/projects/cis210027p/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0321 21:11:25.206000 19847 /ocean/projects/cis210027p/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/run.py:793] *****************************************
[2025-03-21 21:11:31,246] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-21 21:11:31,270] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-21 21:11:31,278] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-21 21:11:31,280] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
INFO 03-21 21:11:33 __init__.py:190] Automatically detected platform cuda.
INFO 03-21 21:11:33 __init__.py:190] Automatically detected platform cuda.
INFO 03-21 21:11:33 __init__.py:190] Automatically detected platform cuda.
INFO 03-21 21:11:33 __init__.py:190] Automatically detected platform cuda.
wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.18.3
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: Tracking run with wandb version 0.18.3
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: Tracking run with wandb version 0.18.3
wandb: Tracking run with wandb version 0.18.3
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
[2025-03-21 21:11:34,944] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-03-21 21:11:34,945] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-03-21 21:11:34,945] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-03-21 21:11:34,945] [INFO] [comm.py:683:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-21 21:11:34,945] [INFO] [comm.py:652:init_distributed] cdb=None
training_args:
 GRPOConfig(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
average_tokens_across_devices=False,
batch_eval_metrics=False,
beta=0.04,
bf16=True,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=local_scripts/zero3_offload.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=False,
ds3_gather_for_generation=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_on_start=False,
eval_steps=None,
eval_strategy=IntervalStrategy.NO,
eval_use_gather_object=False,
evaluation_strategy=None,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=True,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_for_metrics=[],
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=1e-06,
length_column_name=length,
load_best_model_at_end=False,
local_rank=0,
log_completions=False,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=results/runs/Mar21_21-11-34_w004.ib.bridges2.psc.edu,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=1.0,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_kwargs={},
lr_scheduler_type=SchedulerType.LINEAR,
max_completion_length=768,
max_grad_norm=1.0,
max_prompt_length=2048,
max_steps=-1,
metric_for_best_model=None,
model_init_kwargs=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_generations=8,
num_train_epochs=1.0,
optim=OptimizerNames.ADAMW_TORCH,
optim_args=None,
optim_target_modules=None,
output_dir=results,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
ref_model_mixup_alpha=0.9,
ref_model_sync_steps=64,
remove_unused_columns=False,
report_to=['wandb'],
restore_callback_states_from_checkpoint=False,
resume_from_checkpoint=None,
reward_weights=None,
run_name=Qwen2-VL-7B-GRPO-8k,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=SaveStrategy.STEPS,
save_total_limit=30,
seed=42,
skip_memory_metrics=True,
split_batches=None,
sync_ref_model=False,
temperature=0.9,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torch_empty_cache_steps=None,
torchdynamo=None,
tp_size=0,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_liger_kernel=False,
use_mps_device=False,
use_vllm=False,
vllm_device=auto,
vllm_dtype=auto,
vllm_gpu_memory_utilization=0.9,
vllm_max_model_len=None,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
script_args:
 GRPOScriptArguments(dataset_name='lmms-lab/multimodal-open-r1-8k-verified', dataset_config=None, dataset_train_split='train', dataset_test_split='test', gradient_checkpointing_use_reentrant=False, ignore_bias_buffers=False, reward_funcs=['accuracy', 'format'], max_pixels=1000000, min_pixels=3136)
model_args:
 ModelConfig(model_name_or_path='Qwen/Qwen2.5-VL-3B-Instruct', model_revision='main', torch_dtype=None, trust_remote_code=False, attn_implementation='flash_attention_2', use_peft=False, lora_r=16, lora_alpha=32, lora_dropout=0.05, lora_target_modules=None, lora_modules_to_save=None, lora_task_type='CAUSAL_LM', use_rslora=False, load_in_8bit=False, load_in_4bit=False, bnb_4bit_quant_type='nf4', use_bnb_nested_quant=False)
training_args:
 GRPOConfig(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
average_tokens_across_devices=False,
batch_eval_metrics=False,
beta=0.04,
bf16=True,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=local_scripts/zero3_offload.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=False,
ds3_gather_for_generation=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_on_start=False,
eval_steps=None,
eval_strategy=IntervalStrategy.NO,
eval_use_gather_object=False,
evaluation_strategy=None,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=True,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_for_metrics=[],
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=1e-06,
length_column_name=length,
load_best_model_at_end=False,
local_rank=1,
log_completions=False,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=results/runs/Mar21_21-11-34_w004.ib.bridges2.psc.edu,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=1.0,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_kwargs={},
lr_scheduler_type=SchedulerType.LINEAR,
max_completion_length=768,
max_grad_norm=1.0,
max_prompt_length=2048,
max_steps=-1,
metric_for_best_model=None,
model_init_kwargs=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_generations=8,
num_train_epochs=1.0,
optim=OptimizerNames.ADAMW_TORCH,
optim_args=None,
optim_target_modules=None,
output_dir=results,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
ref_model_mixup_alpha=0.9,
ref_model_sync_steps=64,
remove_unused_columns=False,
report_to=['wandb'],
restore_callback_states_from_checkpoint=False,
resume_from_checkpoint=None,
reward_weights=None,
run_name=Qwen2-VL-7B-GRPO-8k,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=SaveStrategy.STEPS,
save_total_limit=30,
seed=42,
skip_memory_metrics=True,
split_batches=None,
sync_ref_model=False,
temperature=0.9,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torch_empty_cache_steps=None,
torchdynamo=None,
tp_size=0,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_liger_kernel=False,
use_mps_device=False,
use_vllm=False,
vllm_device=auto,
vllm_dtype=auto,
vllm_gpu_memory_utilization=0.9,
vllm_max_model_len=None,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)training_args:

script_args:
  GRPOScriptArguments(dataset_name='lmms-lab/multimodal-open-r1-8k-verified', dataset_config=None, dataset_train_split='train', dataset_test_split='test', gradient_checkpointing_use_reentrant=False, ignore_bias_buffers=False, reward_funcs=['accuracy', 'format'], max_pixels=1000000, min_pixels=3136)
training_args:
model_args:
 ModelConfig(model_name_or_path='Qwen/Qwen2.5-VL-3B-Instruct', model_revision='main', torch_dtype=None, trust_remote_code=False, attn_implementation='flash_attention_2', use_peft=False, lora_r=16, lora_alpha=32, lora_dropout=0.05, lora_target_modules=None, lora_modules_to_save=None, lora_task_type='CAUSAL_LM', use_rslora=False, load_in_8bit=False, load_in_4bit=False, bnb_4bit_quant_type='nf4', use_bnb_nested_quant=False)GRPOConfig(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
average_tokens_across_devices=False,
batch_eval_metrics=False,
beta=0.04,
bf16=True,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=local_scripts/zero3_offload.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=False,
ds3_gather_for_generation=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_on_start=False,
eval_steps=None,
eval_strategy=IntervalStrategy.NO,
eval_use_gather_object=False,
evaluation_strategy=None,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=True,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_for_metrics=[],
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=1e-06,
length_column_name=length,
load_best_model_at_end=False,
local_rank=3,
log_completions=False,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=results/runs/Mar21_21-11-34_w004.ib.bridges2.psc.edu,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=1.0,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_kwargs={},
lr_scheduler_type=SchedulerType.LINEAR,
max_completion_length=768,
max_grad_norm=1.0,
max_prompt_length=2048,
max_steps=-1,
metric_for_best_model=None,
model_init_kwargs=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_generations=8,
num_train_epochs=1.0,
optim=OptimizerNames.ADAMW_TORCH,
optim_args=None,
optim_target_modules=None,
output_dir=results,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
ref_model_mixup_alpha=0.9,
ref_model_sync_steps=64,
remove_unused_columns=False,
report_to=['wandb'],
restore_callback_states_from_checkpoint=False,
resume_from_checkpoint=None,
reward_weights=None,
run_name=Qwen2-VL-7B-GRPO-8k,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=SaveStrategy.STEPS,
save_total_limit=30,
seed=42,
skip_memory_metrics=True,
split_batches=None,
sync_ref_model=False,
temperature=0.9,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torch_empty_cache_steps=None,
torchdynamo=None,
tp_size=0,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_liger_kernel=False,
use_mps_device=False,
use_vllm=False,
vllm_device=auto,
vllm_dtype=auto,
vllm_gpu_memory_utilization=0.9,
vllm_max_model_len=None,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)

 script_args:
 GRPOScriptArguments(dataset_name='lmms-lab/multimodal-open-r1-8k-verified', dataset_config=None, dataset_train_split='train', dataset_test_split='test', gradient_checkpointing_use_reentrant=False, ignore_bias_buffers=False, reward_funcs=['accuracy', 'format'], max_pixels=1000000, min_pixels=3136)
GRPOConfig(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
average_tokens_across_devices=False,
batch_eval_metrics=False,
beta=0.04,
bf16=True,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=local_scripts/zero3_offload.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=False,
ds3_gather_for_generation=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_on_start=False,
eval_steps=None,
eval_strategy=IntervalStrategy.NO,
eval_use_gather_object=False,
evaluation_strategy=None,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=True,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_for_metrics=[],
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=1e-06,
length_column_name=length,
load_best_model_at_end=False,
local_rank=2,
log_completions=False,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=results/runs/Mar21_21-11-34_w004.ib.bridges2.psc.edu,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=1.0,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_kwargs={},
lr_scheduler_type=SchedulerType.LINEAR,
max_completion_length=768,
max_grad_norm=1.0,
max_prompt_length=2048,
max_steps=-1,
metric_for_best_model=None,
model_init_kwargs=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_generations=8,
num_train_epochs=1.0,
optim=OptimizerNames.ADAMW_TORCH,
optim_args=None,
optim_target_modules=None,
output_dir=results,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
ref_model_mixup_alpha=0.9,
ref_model_sync_steps=64,
remove_unused_columns=False,
report_to=['wandb'],
restore_callback_states_from_checkpoint=False,
resume_from_checkpoint=None,
reward_weights=None,
run_name=Qwen2-VL-7B-GRPO-8k,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=SaveStrategy.STEPS,
save_total_limit=30,
seed=42,
skip_memory_metrics=True,
split_batches=None,
sync_ref_model=False,
temperature=0.9,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torch_empty_cache_steps=None,
torchdynamo=None,
tp_size=0,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_liger_kernel=False,
use_mps_device=False,
use_vllm=False,
vllm_device=auto,
vllm_dtype=auto,
vllm_gpu_memory_utilization=0.9,
vllm_max_model_len=None,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)model_args:

 script_args:
ModelConfig(model_name_or_path='Qwen/Qwen2.5-VL-3B-Instruct', model_revision='main', torch_dtype=None, trust_remote_code=False, attn_implementation='flash_attention_2', use_peft=False, lora_r=16, lora_alpha=32, lora_dropout=0.05, lora_target_modules=None, lora_modules_to_save=None, lora_task_type='CAUSAL_LM', use_rslora=False, load_in_8bit=False, load_in_4bit=False, bnb_4bit_quant_type='nf4', use_bnb_nested_quant=False) 
GRPOScriptArguments(dataset_name='lmms-lab/multimodal-open-r1-8k-verified', dataset_config=None, dataset_train_split='train', dataset_test_split='test', gradient_checkpointing_use_reentrant=False, ignore_bias_buffers=False, reward_funcs=['accuracy', 'format'], max_pixels=1000000, min_pixels=3136)
model_args:
 ModelConfig(model_name_or_path='Qwen/Qwen2.5-VL-3B-Instruct', model_revision='main', torch_dtype=None, trust_remote_code=False, attn_implementation='flash_attention_2', use_peft=False, lora_r=16, lora_alpha=32, lora_dropout=0.05, lora_target_modules=None, lora_modules_to_save=None, lora_task_type='CAUSAL_LM', use_rslora=False, load_in_8bit=False, load_in_4bit=False, bnb_4bit_quant_type='nf4', use_bnb_nested_quant=False)
Generating train split:   0%|          | 0/7689 [00:00<?, ? examples/s]Generating train split:   1%|â–         | 100/7689 [00:00<00:41, 184.54 examples/s]Generating train split:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2500/7689 [00:00<00:01, 5117.33 examples/s]Generating train split:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 4600/7689 [00:00<00:00, 8684.72 examples/s]Generating train split:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 7100/7689 [00:00<00:00, 12565.55 examples/s]Generating train split: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7689/7689 [00:00<00:00, 8739.17 examples/s] 
Map:   0%|          | 0/7689 [00:00<?, ? examples/s]Map:   0%|          | 0/7689 [00:00<?, ? examples/s]
Map:   0%|          | 0/7689 [00:00<?, ? examples/s]Map:   0%|          | 0/7689 [00:00<?, ? examples/s]
Map:   0%|          | 0/7689 [00:00<?, ? examples/s]Map:   0%|          | 0/7689 [00:00<?, ? examples/s]
Map:   0%|          | 0/7689 [00:00<?, ? examples/s]Map:   0%|          | 0/7689 [00:00<?, ? examples/s]
[rank3]: Traceback (most recent call last):
[rank3]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 196, in <module>
[rank3]:     main(script_args, training_args, model_args)
[rank3]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 157, in main
[rank3]:     dataset = dataset.map(make_conversation_image)
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/dataset_dict.py", line 941, in map
[rank3]:     dataset_dict[split] = dataset.map(
[rank3]:                           ^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 557, in wrapper
[rank3]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank3]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3074, in map
[rank3]:     for rank, done, content in Dataset._map_single(**dataset_kwargs):
[rank3]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3492, in _map_single
[rank3]:     for i, example in iter_outputs(shard_iterable):
[rank3]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3466, in iter_outputs
[rank3]:     yield i, apply_function(example, i, offset=offset)
[rank3]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3389, in apply_function
[rank3]:     processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
[rank3]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 149, in make_conversation_image
[rank3]:     {"type": "image", "image": "file://" + example['image_path']},
[rank3]:                                            ~~~~~~~^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 280, in __getitem__
[rank3]:     value = self.data[key]
[rank3]:             ~~~~~~~~~^^^^^
[rank3]: KeyError: 'image_path'
[rank3]: Traceback (most recent call last):
[rank3]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 196, in <module>
[rank3]:     main(script_args, training_args, model_args)
[rank3]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 157, in main
[rank3]:     dataset = dataset.map(make_conversation_image)
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/dataset_dict.py", line 941, in map
[rank3]:     dataset_dict[split] = dataset.map(
[rank3]:                           ^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 557, in wrapper
[rank3]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank3]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3074, in map
[rank3]:     for rank, done, content in Dataset._map_single(**dataset_kwargs):
[rank3]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3492, in _map_single
[rank3]:     for i, example in iter_outputs(shard_iterable):
[rank3]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3466, in iter_outputs
[rank3]:     yield i, apply_function(example, i, offset=offset)
[rank3]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3389, in apply_function
[rank3]:     processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
[rank3]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 149, in make_conversation_image
[rank3]:     {"type": "image", "image": "file://" + example['image_path']},
[rank3]:                                            ~~~~~~~^^^^^^^^^^^^^^
[rank3]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 280, in __getitem__
[rank3]:     value = self.data[key]
[rank3]:             ~~~~~~~~~^^^^^
[rank3]: KeyError: 'image_path'
[rank1]: Traceback (most recent call last):
[rank1]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 196, in <module>
[rank1]:     main(script_args, training_args, model_args)
[rank1]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 157, in main
[rank1]:     dataset = dataset.map(make_conversation_image)
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/dataset_dict.py", line 941, in map
[rank1]:     dataset_dict[split] = dataset.map(
[rank1]:                           ^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 557, in wrapper
[rank1]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank1]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3074, in map
[rank1]:     for rank, done, content in Dataset._map_single(**dataset_kwargs):
[rank1]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3492, in _map_single
[rank1]:     for i, example in iter_outputs(shard_iterable):
[rank1]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3466, in iter_outputs
[rank1]:     yield i, apply_function(example, i, offset=offset)
[rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3389, in apply_function
[rank1]:     processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
[rank1]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 149, in make_conversation_image
[rank1]:     {"type": "image", "image": "file://" + example['image_path']},
[rank1]:                                            ~~~~~~~^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 280, in __getitem__
[rank1]:     value = self.data[key]
[rank1]:             ~~~~~~~~~^^^^^
[rank1]: KeyError: 'image_path'
[rank1]: Traceback (most recent call last):
[rank1]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 196, in <module>
[rank1]:     main(script_args, training_args, model_args)
[rank1]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 157, in main
[rank1]:     dataset = dataset.map(make_conversation_image)
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/dataset_dict.py", line 941, in map
[rank1]:     dataset_dict[split] = dataset.map(
[rank1]:                           ^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 557, in wrapper
[rank1]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank1]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3074, in map
[rank1]:     for rank, done, content in Dataset._map_single(**dataset_kwargs):
[rank1]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3492, in _map_single
[rank1]:     for i, example in iter_outputs(shard_iterable):
[rank1]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3466, in iter_outputs
[rank1]:     yield i, apply_function(example, i, offset=offset)
[rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3389, in apply_function
[rank1]:     processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
[rank1]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 149, in make_conversation_image
[rank1]:     {"type": "image", "image": "file://" + example['image_path']},
[rank1]:                                            ~~~~~~~^^^^^^^^^^^^^^
[rank1]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 280, in __getitem__
[rank1]:     value = self.data[key]
[rank1]:             ~~~~~~~~~^^^^^
[rank1]: KeyError: 'image_path'
[rank2]: Traceback (most recent call last):
[rank2]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 196, in <module>
[rank2]:     main(script_args, training_args, model_args)
[rank2]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 157, in main
[rank2]:     dataset = dataset.map(make_conversation_image)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/dataset_dict.py", line 941, in map
[rank2]:     dataset_dict[split] = dataset.map(
[rank2]:                           ^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 557, in wrapper
[rank2]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank2]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3074, in map
[rank2]:     for rank, done, content in Dataset._map_single(**dataset_kwargs):
[rank2]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3492, in _map_single
[rank2]:     for i, example in iter_outputs(shard_iterable):
[rank2]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3466, in iter_outputs
[rank2]:     yield i, apply_function(example, i, offset=offset)
[rank2]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3389, in apply_function
[rank2]:     processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
[rank2]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 149, in make_conversation_image
[rank2]:     {"type": "image", "image": "file://" + example['image_path']},
[rank2]:                                            ~~~~~~~^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 280, in __getitem__
[rank2]:     value = self.data[key]
[rank2]:             ~~~~~~~~~^^^^^
[rank2]: KeyError: 'image_path'
[rank2]: Traceback (most recent call last):
[rank2]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 196, in <module>
[rank2]:     main(script_args, training_args, model_args)
[rank2]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 157, in main
[rank2]:     dataset = dataset.map(make_conversation_image)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/dataset_dict.py", line 941, in map
[rank2]:     dataset_dict[split] = dataset.map(
[rank2]:                           ^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 557, in wrapper
[rank2]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank2]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3074, in map
[rank2]:     for rank, done, content in Dataset._map_single(**dataset_kwargs):
[rank2]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3492, in _map_single
[rank2]:     for i, example in iter_outputs(shard_iterable):
[rank2]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3466, in iter_outputs
[rank2]:     yield i, apply_function(example, i, offset=offset)
[rank2]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3389, in apply_function
[rank2]:     processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
[rank2]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 149, in make_conversation_image
[rank2]:     {"type": "image", "image": "file://" + example['image_path']},
[rank2]:                                            ~~~~~~~^^^^^^^^^^^^^^
[rank2]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 280, in __getitem__
[rank2]:     value = self.data[key]
[rank2]:             ~~~~~~~~~^^^^^
[rank2]: KeyError: 'image_path'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 196, in <module>
[rank0]:     main(script_args, training_args, model_args)
[rank0]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 157, in main
[rank0]:     dataset = dataset.map(make_conversation_image)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/dataset_dict.py", line 941, in map
[rank0]:     dataset_dict[split] = dataset.map(
[rank0]:                           ^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 557, in wrapper
[rank0]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank0]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3074, in map
[rank0]:     for rank, done, content in Dataset._map_single(**dataset_kwargs):
[rank0]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3492, in _map_single
[rank0]:     for i, example in iter_outputs(shard_iterable):
[rank0]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3466, in iter_outputs
[rank0]:     yield i, apply_function(example, i, offset=offset)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3389, in apply_function
[rank0]:     processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
[rank0]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 149, in make_conversation_image
[rank0]:     {"type": "image", "image": "file://" + example['image_path']},
[rank0]:                                            ~~~~~~~^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 280, in __getitem__
[rank0]:     value = self.data[key]
[rank0]:             ~~~~~~~~~^^^^^
[rank0]: KeyError: 'image_path'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 196, in <module>
[rank0]:     main(script_args, training_args, model_args)
[rank0]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 157, in main
[rank0]:     dataset = dataset.map(make_conversation_image)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/dataset_dict.py", line 941, in map
[rank0]:     dataset_dict[split] = dataset.map(
[rank0]:                           ^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 557, in wrapper
[rank0]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank0]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3074, in map
[rank0]:     for rank, done, content in Dataset._map_single(**dataset_kwargs):
[rank0]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3492, in _map_single
[rank0]:     for i, example in iter_outputs(shard_iterable):
[rank0]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3466, in iter_outputs
[rank0]:     yield i, apply_function(example, i, offset=offset)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3389, in apply_function
[rank0]:     processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
[rank0]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/src/open_r1/grpo_vllm.py", line 149, in make_conversation_image
[rank0]:     {"type": "image", "image": "file://" + example['image_path']},
[rank0]:                                            ~~~~~~~^^^^^^^^^^^^^^
[rank0]:   File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 280, in __getitem__
[rank0]:     value = self.data[key]
[rank0]:             ~~~~~~~~~^^^^^
[rank0]: KeyError: 'image_path'
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/wandb/offline-run-20250321_211133-z4i0yptr[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250321_211133-z4i0yptr/logs[0m
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/wandb/offline-run-20250321_211133-stj9ycj5[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250321_211133-stj9ycj5/logs[0m
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/wandb/offline-run-20250321_211133-4d7r0xlw[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250321_211133-4d7r0xlw/logs[0m
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /ocean/projects/cis210027p/qwang20/R1-Multimodal-Journey/wandb/offline-run-20250321_211133-5syfr4ae[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250321_211133-5syfr4ae/logs[0m
[rank0]:[W321 21:11:48.909918329 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
W0321 21:11:49.343000 19847 /ocean/projects/cis210027p/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 19898 closing signal SIGTERM
W0321 21:11:49.344000 19847 /ocean/projects/cis210027p/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 19899 closing signal SIGTERM
W0321 21:11:49.344000 19847 /ocean/projects/cis210027p/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 19900 closing signal SIGTERM
E0321 21:11:49.722000 19847 /ocean/projects/cis210027p/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 0 (pid: 19897) of binary: /jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/bin/python
Traceback (most recent call last):
  File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/run.py", line 919, in main
    run(args)
  File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/run.py", line 910, in run
    elastic_launch(
  File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/jet/home/qwang20/miniconda3/envs/open_r1_mm_fix/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
src/open_r1/grpo_vllm.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-03-21_21:11:49
  host      : w004.ib.bridges2.psc.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 19897)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
